# Key calculation for adopted users
def calculate_adopted_users(engagement_df):
    # Group by user and date
    user_logins = engagement_df.groupby(['user_id', pd.Grouper(key='time_stamp', freq='D')]).size().reset_index()
    
    adopted_users = []
    for user_id, group in user_logins.groupby('user_id'):
        dates = group['time_stamp'].sort_values().reset_index(drop=True)
        adopted = False
        for i in range(len(dates) - 2):
            if (dates[i + 2] - dates[i]).days <= 7:
                adopted = True
                break
        adopted_users.append((user_id, adopted))
    
    return pd.DataFrame(adopted_users, columns=['user_id', 'adopted_user'])


#Conclusion: 

#The strongest predictors of user adoption are signing up via Google Auth, using a gmail.com email, and being part of an organization. Product teams should optimize the onboarding experience for these high-potential user segments while investigating why personal project users show lower engagement.